IF plantType == primaryOnly:
	IF ((QRequired < 1.1 * BStageMin_current FOR 5 minutes) 
		OR (minFlowBypassValve is OPEN FOR 5 minutes)) 
		AND...failsafeCondition_lowerStage == FALSE 
		AND...(QRequired < 0.8 * QbX_lowerStage FOR 5 minutes):  # Please make sure QbX_lowerStage is the next available low stage
			set stage = stage_lower

ELSE:
	IF currentStage_nonCondensingBoilers == absent:  # This clause should be for condensing boiler
		IF (QRequired < 1.1 * BStageMin_current FOR 5 minutes) 
				OR ((priPumpFlowRate == minPriPumpSpeed_current) 
					AND (priHWRT > secHWRT + 3 deg.F FOR 5 minutes))) 
			AND...failsafeCondition_lowerStage == FALSE 
			AND...(QRequired < 0.8 * QbX_lowerStage FOR 5 minutes):
				set stage = stage_lower
			
	ELSE IF currentStage_nonCondensingBoilers == present:  # this clause should be for non-condensing boiler
		IF (QRequired < 0.8 * QDes_lower FOR 10 minutes) 
		AND (failsafeCondition_lowerStage == FALSE):
			set stage = stage_lower